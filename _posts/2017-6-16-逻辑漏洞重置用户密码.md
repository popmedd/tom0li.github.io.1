---
layout: post
title: cookie覆盖重置用户密码
categories: [blog ]
tags: [Web安全, ]
---
> cookie覆盖 逻辑漏洞 ，测试某号店，已修补，

### 0x01 过程
登陆界面 忘记密码处，通过手机找回

同一浏览器下  
第一个手机号  （可控）

 第一步 输入 手机 验证码 可确定用户 cookie 
![pwd-one](https://raw.githubusercontent.com/tom0li/tom0li.github.io/master/images/pwd-one.png) 

![pwd-two](https://raw.githubusercontent.com/tom0li/tom0li.github.io/master/images/pwd-two.png) 

正常到第三步，设置新密码，不关闭页面，这里就不传图了

第二个手机号  （受害者）
输入受害者手机号 重新提交第一步  

刷新第一个手机号页面，设置新密码
![pwd-four](https://raw.githubusercontent.com/tom0li/tom0li.github.io/master/images/pwd-four.png) 

可重置受害者密码

     管理员手机信息获取，你们懂

### 0x02 参考
http://wooyun.jozxing.cc/static/drops/web-5048.html

http://wooyun.jozxing.cc/static/drops/web-3295.html

http://wooyun.jozxing.cc/static/drops/papers-2035.html

http://docs.ioin.in/writeup/blog.heysec.org/_archives_643/index.html

https://bbs.ichunqiu.com/thread-21161-1-1.html

http://blkstone.github.io/2017/05/28/finding-src-vuls/

